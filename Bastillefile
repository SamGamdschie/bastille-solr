PKG zsh vim-console git-lite htop apache-solr curl

#CMD mkdir -p /www/certificates
#CMD mkdir -p /usr/local/etc/git_config/solr

MOUNT /usr/ports usr/ports nullfs ro 0 0 
#MOUNT /werzel/mail var/mail nullfs rw 0 0
#MOUNT /werzel/certificates www/certificates nullfs ro 0 0
#MOUNT /werzel/server_config/clamav usr/local/etc/clamav nullfs ro 0 0
#MOUNT /werzel/server_config/dovecot usr/local/etc/dovecot nullfs ro 0 0
#MOUNT /werzel/server_config/redis usr/local/etc/redis nullfs ro 0 0
#MOUNT /werzel/server_config/rspamd/local.d usr/local/etc/rspamd/local.d  nullfs ro 0 0
#MOUNT /werzel/server_config/postfix usr/local/etc/postfix  nullfs ro 0 0

# Link Configurations to /usr/local/etc/ from /usr/local/etc/git_config/*/
#CMD rm -rf /usr/local/etc/redis.conf
#CMD ln -s /usr/local/etc/redis.conf /usr/local/etc/git_config/redis/redis.conf

# Prepare SOLr for Dovecot Collection
CMD su -m solr -c "/usr/local/solr/bin/solr create -c dovecot -n dovecot"
CMD rm /var/db/solr/dovecot/conf/managed-schema
CMD curl -o /var/db/solr/dovecot/conf/schema.xml https://www.c0ffee.net/files/schema.xml
CMD curl -o /var/db/solr/dovecot/conf/solrconfig.xml https://www.c0ffee.net/files/solrconfig.xml
CMD chown solr:solr /var/db/solr/dovecot/conf/{schema,solrconfig}.xml
 
SYSRC solr_enable=YES

SERVICE solr start

